<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>å—é–€åœ‹å°æ‹¼å­—æŒ‘æˆ° Go</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:system-ui;background:#f5f7fb;margin:0;padding:20px}
.card{background:#fff;border-radius:18px;padding:22px;max-width:520px;margin:auto;box-shadow:0 10px 30px rgba(0,0,0,.1)}
h1{text-align:center;margin:0 0 10px}
.top{display:flex;justify-content:space-between;align-items:center}
button{width:100%;padding:14px;margin:8px 0;border:none;border-radius:14px;font-size:18px}
.listen{background:#4f7cff;color:#fff}
.option{background:#eef1f7}
.option:hover{background:#dbe3ff}
.hidden{display:none}
.small{font-size:14px;color:#666;text-align:center}
input{width:100%;padding:14px;font-size:18px;border-radius:12px;border:1px solid #ccc}

/* åœ°åœ– */
.map{display:flex;flex-direction:column;align-items:center}
.level{width:70px;height:70px;border-radius:50%;margin:14px 0;display:flex;
align-items:center;justify-content:center;font-size:20px;font-weight:bold}
.locked{background:#ccc;color:#666}
.current{background:#4f7cff;color:#fff;cursor:pointer}
.done{background:gold;color:#333}
.path{width:6px;height:30px;background:#ddd}
</style>
</head>

<body>

<div class="card" id="login">
  <h1>ğŸ« å—é–€åœ‹å°æ‹¼å­—æŒ‘æˆ° Go</h1>
  <p class="small">è«‹è¼¸å…¥å­¸ç”Ÿå§“å</p>
  <input id="studentName" placeholder="ä¾‹å¦‚ï¼šç‹å°æ˜">
  <button onclick="login()">é–‹å§‹</button>
</div>

<div class="card hidden" id="mapPage">
  <div class="top">
    <strong id="studentLabel"></strong>
    <button onclick="exportCSV()">ğŸ‘©â€ğŸ«</button>
  </div>
  <h2 style="text-align:center">ğŸ—ºï¸ é—œå¡åœ°åœ–</h2>
  <div class="map" id="map"></div>
</div>

<div class="card hidden" id="game">
  <p id="progress" class="small"></p>
  <div id="question"></div>
  <div id="options"></div>
</div>

<script>
/* ===== 153 å­— ===== */
const WORDS = [
{en:"able",zh:"èƒ½å¤ "},{en:"about",zh:"é—œæ–¼"},{en:"after",zh:"ä¹‹å¾Œ"},
{en:"again",zh:"å†ä¸€æ¬¡"},{en:"air",zh:"ç©ºæ°£"},{en:"all",zh:"å…¨éƒ¨"},
{en:"always",zh:"ç¸½æ˜¯"},{en:"animal",zh:"å‹•ç‰©"},{en:"answer",zh:"å›ç­”"},
{en:"apple",zh:"è˜‹æœ"},{en:"ask",zh:"å•"},{en:"baby",zh:"å¬°å…’"},
{en:"back",zh:"å¾Œé¢"},{en:"ball",zh:"çƒ"},{en:"bed",zh:"åºŠ"},
{en:"big",zh:"å¤§çš„"},{en:"bird",zh:"é³¥"},{en:"black",zh:"é»‘è‰²"},
{en:"blue",zh:"è—è‰²"},{en:"book",zh:"æ›¸"},{en:"boy",zh:"ç”·å­©"},
{en:"bread",zh:"éºµåŒ…"},{en:"bring",zh:"å¸¶ä¾†"},{en:"brother",zh:"å“¥å“¥"},
{en:"bus",zh:"å…¬è»Š"},{en:"cake",zh:"è›‹ç³•"},{en:"cat",zh:"è²“"},
{en:"chair",zh:"æ¤…å­"},{en:"chicken",zh:"é›"},{en:"child",zh:"å°å­©"},
{en:"clean",zh:"ä¹¾æ·¨"},{en:"close",zh:"é—œ"},{en:"cold",zh:"å†·"},
{en:"come",zh:"ä¾†"},{en:"cow",zh:"ç‰›"},{en:"day",zh:"ç™½å¤©"},
{en:"desk",zh:"æ›¸æ¡Œ"},{en:"dog",zh:"ç‹—"},{en:"door",zh:"é–€"},
{en:"down",zh:"å‘ä¸‹"},{en:"drink",zh:"å–"},{en:"eat",zh:"åƒ"},
{en:"egg",zh:"è›‹"},{en:"end",zh:"çµæŸ"},{en:"eye",zh:"çœ¼ç›"},
{en:"face",zh:"è‡‰"},{en:"family",zh:"å®¶äºº"},{en:"fast",zh:"å¿«"},
{en:"father",zh:"çˆ¸çˆ¸"},{en:"fish",zh:"é­š"},{en:"flower",zh:"èŠ±"},
{en:"food",zh:"é£Ÿç‰©"},{en:"friend",zh:"æœ‹å‹"},{en:"fun",zh:"å¥½ç©"},
{en:"game",zh:"éŠæˆ²"},{en:"girl",zh:"å¥³å­©"},{en:"go",zh:"å»"},
{en:"good",zh:"å¥½çš„"},{en:"green",zh:"ç¶ è‰²"},{en:"hand",zh:"æ‰‹"},
{en:"happy",zh:"å¿«æ¨‚"},{en:"hat",zh:"å¸½å­"},{en:"have",zh:"æœ‰"},
{en:"head",zh:"é ­"},{en:"help",zh:"å¹«å¿™"},{en:"home",zh:"å®¶"},
{en:"hot",zh:"ç†±"},{en:"house",zh:"æˆ¿å­"},{en:"hungry",zh:"é¤“"},
{en:"ice",zh:"å†°"},{en:"jump",zh:"è·³"},{en:"kind",zh:"å–„è‰¯"},
{en:"kite",zh:"é¢¨ç®"},{en:"leg",zh:"è…³"},{en:"like",zh:"å–œæ­¡"},
{en:"lion",zh:"ç…å­"},{en:"little",zh:"å°çš„"},{en:"look",zh:"çœ‹"},
{en:"love",zh:"æ„›"},{en:"man",zh:"ç”·äºº"},{en:"many",zh:"å¾ˆå¤š"},
{en:"milk",zh:"ç‰›å¥¶"},{en:"mother",zh:"åª½åª½"},{en:"mouse",zh:"è€é¼ "},
{en:"name",zh:"åå­—"},{en:"near",zh:"é è¿‘"},{en:"new",zh:"æ–°çš„"},
{en:"night",zh:"æ™šä¸Š"},{en:"nose",zh:"é¼»å­"},{en:"open",zh:"æ‰“é–‹"},
{en:"orange",zh:"æ©˜å­"},{en:"paper",zh:"ç´™"},{en:"park",zh:"å…¬åœ’"},
{en:"pen",zh:"ç­†"},{en:"pencil",zh:"é‰›ç­†"},{en:"play",zh:"ç©"},
{en:"rain",zh:"ä¸‹é›¨"},{en:"read",zh:"è®€"},{en:"red",zh:"ç´…è‰²"},
{en:"rice",zh:"é£¯"},{en:"run",zh:"è·‘"},{en:"school",zh:"å­¸æ ¡"},
{en:"see",zh:"çœ‹è¦‹"},{en:"sheep",zh:"ç¾Š"},{en:"shoe",zh:"é‹å­"},
{en:"sing",zh:"å”±æ­Œ"},{en:"sister",zh:"å§Šå§Š"},{en:"sit",zh:"å"},
{en:"sleep",zh:"ç¡è¦º"},{en:"small",zh:"å°"},{en:"snow",zh:"ä¸‹é›ª"},
{en:"son",zh:"å…’å­"},{en:"star",zh:"æ˜Ÿæ˜Ÿ"},{en:"sun",zh:"å¤ªé™½"},
{en:"table",zh:"æ¡Œå­"},{en:"teacher",zh:"è€å¸«"},{en:"thank",zh:"æ„Ÿè¬"},
{en:"time",zh:"æ™‚é–“"},{en:"tiger",zh:"è€è™"},{en:"toy",zh:"ç©å…·"},
{en:"tree",zh:"æ¨¹"},{en:"up",zh:"å‘ä¸Š"},{en:"walk",zh:"èµ°"},
{en:"water",zh:"æ°´"},{en:"white",zh:"ç™½è‰²"},{en:"window",zh:"çª—æˆ¶"},
{en:"work",zh:"å·¥ä½œ"},{en:"yellow",zh:"é»ƒè‰²"}
];

const TOTAL=100;
let student="",data={};

function login(){
  student=document.getElementById("studentName").value.trim();
  if(!student)return;
  document.getElementById("login").classList.add("hidden");
  document.getElementById("mapPage").classList.remove("hidden");
  document.getElementById("studentLabel").innerText=student;
  data=JSON.parse(localStorage.getItem("nm_"+student))||{level:1,q:0,log:[]};
  renderMap();
}

function save(){localStorage.setItem("nm_"+student,JSON.stringify(data));}

function renderMap(){
  const map=document.getElementById("map");
  map.innerHTML="";
  for(let i=1;i<=TOTAL;i++){
    const d=document.createElement("div");
    d.className="level";
    if(i<data.level){d.classList.add("done");d.innerText="â­";}
    else if(i===data.level){d.classList.add("current");d.innerText=i;d.onclick=()=>startLevel(i);}
    else{d.classList.add("locked");d.innerText="ğŸ”’";}
    map.appendChild(d);
    if(i<TOTAL){const p=document.createElement("div");p.className="path";map.appendChild(p);}
  }
}

function startLevel(l){
  data.q=0;
  data.level=l;
  save();
  document.getElementById("mapPage").classList.add("hidden");
  document.getElementById("game").classList.remove("hidden");
  next();
}

function speak(w){speechSynthesis.speak(new SpeechSynthesisUtterance(w));}
function shuffle(a){return [...a].sort(()=>Math.random()-.5);}

function next(){
  if(data.q>=10){data.level++;save();document.getElementById("game").classList.add("hidden");document.getElementById("mapPage").classList.remove("hidden");renderMap();return;}
  document.getElementById("progress").innerText=`ç¬¬ ${data.level} é—œï¼ˆ${data.q+1}/10ï¼‰`;
  const w=WORDS[(data.level*10+data.q)%WORDS.length];
  const mode=["è½","çœ‹","é…å°"][Math.floor(Math.random()*3)];
  data.q++;save();
  document.getElementById("options").innerHTML="";
  if(mode==="è½"){
    document.getElementById("question").innerHTML=`<button class="listen" onclick="speak('${w.en}')">ğŸ”Š è½</button>`;
  }else{
    document.getElementById("question").innerHTML=`<h2>${w.en}</h2>`;
  }
  const opts=shuffle([w.zh,...WORDS.filter(x=>x.zh!==w.zh).slice(0,3).map(x=>x.zh)]);
  opts.forEach(o=>{
    const b=document.createElement("button");
    b.className="option";
    b.innerText=o;
    b.onclick=()=>{if(o!==w.zh)data.log.push({student,level:data.level,en:w.en,zh:w.zh,mode});save();setTimeout(next,500);}
    document.getElementById("options").appendChild(b);
  });
}

function exportCSV(){
  let rows=[];
  for(let k in localStorage){
    if(k.startsWith("nm_")){
      JSON.parse(localStorage[k]).log.forEach(r=>{
        rows.push(`${r.student},${r.level},${r.mode},${r.en},${r.zh}`);
      });
    }
  }
  const csv="å­¸ç”Ÿ,é—œå¡,é¡Œå‹,è‹±æ–‡,ä¸­æ–‡\n"+rows.join("\n");
  window.open(URL.createObjectURL(new Blob([csv],{type:"text/csv"})));
}
</script>
</body>
</html>
